The easy answer would be to attribute it to Feuerbach, but as with most easy answers—when it comes to Marx—this answer is _too_ easy. Let us start with the famous quote in full:
This is the young Marx—while I do not agree with Althusser's "epistemological break" in Marx, I do not reject that Marx, as all people do, developed his thought over time, and that there was at least some development in his interests and his positions—undoubtedly lying sleepless in his bed, with his worry over the human spirit and its alienation. But the same young Marx doesn't _reject_ religion in this famous passage, as many interpreters have presented it as. Quite contrary, our young Rhenish friend presents here a quite understanding image of religion. "The sigh of the oppressed creature" is the human essence, longing for a freedom that does not exist in Earthly terms. It is false, that much Marx still maintains. But it isn't condemnation of religion we see here, religion is "bad" _per se_ to the young Marx. What Marx _actually_ condemns here, but more clearly in the _Thesis on Feuerbach_ later, is the simple _criticism of religion_, and _not_ religion on its own. Marx actually writes about this, in the passage just above the more famous above quoted passage:
What we often hear about Marx, this great emancipatory thinker, isn't always the truth, and when it is the truth, such as in this short quote, it is seldom the whole truth. I hope to have, with my short comment, shown how a near study of Marx's texts, may show the preconceived notions about Marx are wrong. Working with the very text we know the quote from, we get a completely different picture of what it means, from the general preconceived notion of the anti-religious Marx. Marx was anti-ideology, of which religion happens to be part. But he does not reject spirituality, and hence religion in its broadest sense.
Marx thus rejected religion as such, but from this should not be extrapolated a rejection of the spiritual. We know from Marx's amazing style of writing, that texts like the Bible and figures from Jewish mythology were no strangers to him, and he gladly, even as the "older" Marx, used references to folklore and mythology. But also on the personal spiritual level, in the text we examined above, Marx is very explicit, that the criticism of religion, and of the world that it is a product of, isn't just to rid man of whatever happiness that they may derive from their religion, but rather, to create a society where man can be the focus of man:
If Marx interprets religion as being a product of the economy, and just a way to perpetuate it, wouldn't that invariably extend all forms of "cultural perpetuation" such as music, literature, painting, architecture, etc.?
Well... I wouldn't say that Marx wasn't critical of religion, or believed that it is a neutral thing. He was quite clear in his presentation of religion _as_ ideology, and hence as something that was, as I put it above, part of the powers that be. Ideology, being, together with violence and the mute compulsion of capital, one of the forms of ways that the capitalist system is upheld.
So, what Marx is saying, is that religion can, and does, take on a role as ideology, not that it is born out of the way the capitalist mode of production works. And to be fair, I find no way of reading Marx, that would support such a claim.
I bet you can see where Marx is going now, right? Marx isn't actually about that criticism of religion. He is about the "ruthless criticism of all that exists." And the young Marx, wonderfully dialectically, extracts from the criticism of religion, in a still visibly Feuerbachian way, the criticism of law, the state, society as it is. And as Marx further goes on to say in his thesis IV:
5: Marx, Karl. "Critique of Hegel's Philosophy of Right. Introduction" in _Early Writings_. Penguin Books. 1975. p. 244.