One thing that keeps North Korean leaders up at night, that a lot of Americans don't understand, is their potential to be "Belgianized".
This is the scenario that keeps NK leaders scared. They have no control over when the US and China go to war, but if they ever do, North Korea will almost certainly become the victim of great power politics.
Sure, China and Russia won't like South Korea or Japan developing nuclear weapons, but maybe they should have thought about that before enabling the likes of North Korea or Iran.
Yes, but reunifying under South Korea while US military presence is in the country will not happen either: North Korea is a buffer zone and China won't like to have US military on their doorstep.
But to give China some benefit of the doubt, a collapse North Korea would probably meant the Korean peninsula would be united under a pro-Western banner, since South Korea would want to take advantage of it. Also, there is a decent chance, hoard North Korean refugees might flood their borders.