You, yourself, know that there's more to this than your son is willing to admit. You also know he has a history of inappropriate behaviour - the suspension for the stupidity with the hairspray is one thing, but he's also trying to provoke fights, using inappropriate and racist language, and has previously been in trouble for all of this. Now he has been involved with something that, from the outside, looks a lot like threatening fellow students with firearms, right on the heels of yet another school shooting.
Parenting is hard, and there's no mandatory training before you're thrown in the deep end. From your post history, it's clear you, yourself, are struggling as well. Aside from getting your son a lawyer here and now, I'd also encourage you to speak to a child psychologist about getting support for your son, and about getting support for yourself in how to effectively undo some of the damage wrought by whatever he's going through.
Your son is in crisis. Whatever you and his father are doing to guide him, it isn't working, and the sooner you accept that and seek appropriate help and support for yourselves as parents, and for your son as a kid in need, the better the outcomes will be.
Then your ex would start talking about your child's incredibly worrying behavior since living with you more, the terrible influence of the friends your son has near your home, and the improvement in the child's behavior and academics seen when the child was at dad's 5 days a week. Dad would then argue that many of the child's problems would likely be addressed by a change in venue which would remove your son from his troubling friends and place him in a new school where he could start over. Dad would also likely talk about how under his custody the child would have no or limited access to social media (which the child clearly cannot handle), a brick phone, and would resume therapy (which the child clearly needs)...all things dad has tried to push for previously but were undermined by you.
You need to stop looking to blame dad, focus on the actual issue at hand (your son's behavior), and address that directly. Failure to do so will result in your son's behavior continuing to escalate, and the next escalation is likely going to be directly into the criminal justice system. This is a crisis. You NEED to put everything else aside to partner WITH dad and focus on correcting your son's behavior RIGHT NOW.
Because under your care and watch, your son's behavior has deteriorated, while you've thwarted your ex's attempts to address your son's behavior. All according to your account of your son's recent troubles.
OP, we're absolutely trying to get you to understand that a LOT of your actions are not helping your son at all. You got some GREAT advice on the other sub, and you'd do well to follow it. You actively avoiding conflict with your son and taking the "be his friend" approach is enabling his worsening behavior.
Your son is behaving in ways that are extremely troubling, reflect a dangerous history of behavior and attitudes, and it seems like you and your ex aren't actually dealing with this. This is going to end badly if you don't make serious and steep investments into dealing with this issue today, now.