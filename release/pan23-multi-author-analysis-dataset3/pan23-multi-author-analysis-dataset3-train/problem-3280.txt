If building nuclear capable ICBMs is irrational, then the US, Russia, UK, India, China, France are all just as irrational - since they also have nuclear capable ICBMs.
If you assume an irrational actor, you have to assume a nuclear attack sooner or later and should strike first. He is not irrational but cruel and without empathy for his people. He wants to stay in power, which means he does not want to be annihilated by a nuclear counter strike which would be the precise consequence of an attack on the US. He rattles the sabre to remind people not to attack him. The current situation is the ideal outcome for him, there is literally nothing to gain for him in a nuclear war.
Fun fact: In the event of specific conditions like if the US is ever taken over, the president and other important people killed in the midst of a nuclear war, etc. - those submarine commanders are authorized to have full discretion over the targeting and use of their on-board arsenal. One of those subs could basically destroy the planet, and we have a lot of them at sea, 24/7.
The entire system is set up to ensure that no matter what happens, no matter who wins, if one nation uses them, the planet is destroyed. That's the only way the US and USSR could make sure neither attacked with nukes.
North Korea would be wiped off the planet within 15mins of them firing something at the United States, even they know that. China is the country that protects the North Korean regime and allows the nonsense to continue but even they won’t allow a major nuclear outbreak if it gets to that point.
The whole point of them building up a nuclear arsenal is to join the “we’re untouchable” club…having nukes ready to deploy at any moment will guarantee the survival of the Kim regime.