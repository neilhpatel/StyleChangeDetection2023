This has actually been a longrunning debate in schools of Islamic jurisprudence over what qualifies as khamr (intoxicant, plural khumur), which is explicitly forbidden by both God in the Qur'an and the Prophet Mohammed in the Hadith.
On one side were the Maliki and Shafi schools, with their roots in Arabia, which advocate the belief that all alcoholic beverages are khumur and are therefore forbidden. This goes back to the days of the Maliki school's founder, Malik ibn Anas, who cited scriptural evidence for general prohibition based on the Qur'an and Hadith. Later Maliki scholars like Sanhun would say that the prohibition applies to drinks with even the capacity to ferment, though later scholars abandoned this view. Similarly, the founding Shafi scholar Idris al-Shafi argued for general prohibition based on the traditions of early Islamic communities. Later Shafi scholars like al-Mawardi, al-Baghawi, and al-Rafi'i focus largely on using their claims to counter the Hanafi stance.
On the other side was the Hanafi school, with its roots in Iraq, which argued that only alcoholic beverages explicitly mentioned in the Qur'an and the Hadith (grape & date wine) are forbidden. They also claim that that it is not drinking per se that is the sin, but drunkenness, citing verses such as one from the Hadith where Muhammad condemned the "last cup which intoxicates." This narrow prohibition started with the school's founder, Abu Hanifa, based on his literal interpretation of Quranic verses on khamr. Much of the debates within the Hanafi ask whether it only applies to only grape & date wines, all grape & date juice drinks, or only certain methods of production or fermentation. Starting in the 12th century with scholars like al-Marghinani, Hanafi scholars began declaring broader and broader categories of alcohol unlawful. By the 14th century, the belief in general prohibition of alcohol was commonly accepted, and works of earlier Hanafi founders were reinterpreted to keep things ideologically consistent.
Since ibn Fadlan served in the Abbasid court at Baghdad, where the Hanafi school was flourishing in the 10th century, it's perfectly reasonable for him to hold such a stance.
Why did the former stance eventually win out over the latter? As the 12th century Maliki scholar Ibn Rushd (better known in the west as Averroes) points out in his treatise Bidayat al-Mujtahid, the Hanafi school has a weaker legal basis. There's essentially a hierarchy of precedence when it comes for determining Islamic law: explicit commands in the Qur'an.
My main source was "Contesting Intoxication: Early Juristic Debates over the Lawfulness of Alcoholic Beverages" by Najam Haider in Islamic Law & Society (which can be read , with some supplementary info from John Esposito's book Islam: the Straight Path.
The Hanbali grew out of the Shafi school (with Ahmad ibn Hanbal being a student of Idris al-Shafi) and fell on the "general prohibition" side, but as Haider points out, they never really actively participated in the debate with the Hanafis.
Are there any books that deal with the history of alcoholnin Islam? Specifically, hoe wide spread was its use before, cultures which resisted prohibition when the became Islamic, and how norms concerning alcohol changed or did not change under Islam?
My main source was "Contesting Intoxication: Early Juristic Debates over the Lawfulness of Alcoholic Beverages" by Najam Haider in Islamic Law & Society (which can be read , with some supplementary info from John Esposito's book Islam: the Straight Path.