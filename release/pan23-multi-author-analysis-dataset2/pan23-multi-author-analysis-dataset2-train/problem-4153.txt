You need to contact a lawyer. First off, prescribed medication is not an "illicit substance", so that charge is bogus.
Amphetamines (like Adderall) can impair a driver, but generally courts find that a person taking ADD medication at the prescribed dose is not impaired. In order to accurately charge you with DUI (which the officer did not, but still), you would need to fail/refuse a field sobriety test.
Where it gets tricky is that you willingly told the officer you had just taken a drug, and willingly gave him the bottle. Hard to argue unlawful search/siezure there, but him taking a labelled prescription bottle for analysis is really bizarre.
Get a lawyer to sort this out for you. It may be a little pricey, but you really don't want a pseudo-DUI on your record when you did absolutely nothing wrong.
Did OP really "willingly give him the bottle"? OP showed him the bottle and ID for the purposes of verifying he was the owner, but from the story did not provide any authorization for the officer to keep the bottle. Wouldn't it classify as a seizure (whether it's unlawful is another question)?
Scientific research has shown that for those with ADHD, taking the prescribed medication improves the patient‘s driving, by permitting them to pay more attention to surrounding traffic. It is only when the medication wears off that impaired driving begins to be seen. The officer in this case can’t even say if OP was impaired because he didn’t even do any field sobriety tests. Anything, when used incorrectly, can impair driving. What’s next, officers confiscating your 6pk of beer that was purchased at the grocery store while you’re on the way home? Even if you drink from an open container while driving, it’s not indicative of being automatically impaired and field sobriety test are used to determine this.
As you correctly admitted, amphetamines (Adderall) can impair a driver. Whether a California prosecutor or court will see it as worth pursuing is anyone's guess, but it is nonetheless a perfectly valid charge.
We don't know the exact ticket/NTA she was given, but if the charge itself involves the word "illicit" (possible since OP regurgitated it) then it may indeed be straight up invalid since "illicit" (by definition) means illegal. Obviously the DA would decide on the ultimate charge if it's criminal, but if this is just a ticket then OP (or their lawyer) could make that argument in traffic court if the charge specifically says "illicit".
Certainly it's true that California law considers ANY impairing substance to be worthy of a DUI, but again courts generally find that a person taking prescribed ADD medication at the recommended dose is not impaired. You're correct that it's ultimately on the prosecutor to decide whether or not to move forward, but OP's lawyer may be able to have the charges dismissed entirely based on the facts presented. OP was treating a documented condition with prescribed medication at a therapeutic dose - there was no intention to drive impaired, nor was OP determined to be impaired.