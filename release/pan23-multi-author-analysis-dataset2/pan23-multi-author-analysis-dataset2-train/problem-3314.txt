The former rather than the latter. For heavy anti-aircraft guns, if an aircraft was flying at 200 mph at 20,000 feet it would take an artillery shell around 20 seconds to reach that height, during which time the aircraft would have travelled more than a mile. To judge where to aim mechanical or electro-mechanical analogue computers called directors (in US service) or predictors (in UK service) predicted the position of an aircraft and directed anti-aircraft guns accordingly. A British Path√© film, , shows a Vickers predictor in action - speed is gauged by tracking a target, wind speed is entered on a dial, height is measured by a separate instrument (in you can see a gun in the background and predictor in the foreground with stereoscopic height and range finders behind it). The predictor combines these inputs to calculate the aiming point for the guns and fuse timing - shells exploded in a cloud of fragments so a direct hit was not necessary. If the inputs were wrong or the aircraft changed direction while the shell was on the way the gun would miss, so it's not terribly surprising that Edward Westermann in Flak: German Anti-aircraft Defenses 1914-1945 gives figures of between 3,000 and 16,000 shells fired per aircraft brought down, depending on the condition of the guns, crew training etc.
A direct hit on an aircraft, or close detonation, would usually be fatal. The Germans found it took their fighters around 15-20 hits from 20mm shells to bring down a heavy bomber but only 3-4 30mm shells; heavy flak used much larger 88mm or 128mm shells. As direct hits were so difficult to achieve, far more bombers were damaged by the fragments of near-misses than brought down - for every aircraft of the US 15th Air Force shot down by flak in mid-1944, another 10 were damaged; the 8th Air Force lost 341 aircraft over three months to flak, another 10,972 suffered flak damage. In many cases a hole from a small fragment could be quickly patched over, but even heavy bombers could carry little armour; single-engine single-seat aircraft could be brought down by a single lucky (or unlucky, depending on perspective) hit to the pilot or critical engine component, bombers at least had redundancy in both crew and engines so could return with, at times, heavy damage.
It was certainly an issue, both the shrapnel and also shells that failed to explode at altitude; the City of Westminster's , for example, records anti-aircraft shells, both exploded and unexploded, and there are some specific incidents with more detail such as two casualties caused by an AA shell on , but I haven't come across anything that looks at it specifically.
How serious a concern was falling debris during and after WW2 air raids? Most media just have the grand shots of bombers being lit up by spotlights and flares. But 3000-16000 shells is a lot of metal falling back down to the ground. How dangerous was this shrapnel to someone unwisely not under cover? And how much of it was a problem after a raid? Were farm machines/etc being fouled on a regular basis because a piece of shrapnel got picked up?
And if I can put on you even more, were there ever any concern over the economics of anti air weapons? I'm sure a plane and crew were ridiculously valueble, but so are thousands anti air rounds.
"Boys searched the ruins for shrapnel, prizing pieces of German bomb more highly than the splinters of A. A. shells." (Calder, The People's War).
"Children in Leningrad played games with the shrapnel picked up after the anti-aircraft barrage. Svetlana Magaieva and her companions even stayed outside while the shrapnel fell, on the promise that whoever stood nearest a fallen fragment would have the right to claim it." (Overy, The Bombing War).