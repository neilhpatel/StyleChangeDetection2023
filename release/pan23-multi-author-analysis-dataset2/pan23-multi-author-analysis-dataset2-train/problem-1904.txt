is from Robert Hunt's book on Cornish folklore (1865) - and I am certain this is not the oldest visual reference; the image of the earliest witch's hat clearly predates the Wizard of Oz, which means Wiki may be wrong - a moment in history just in itself.
I have seen speculation that the pointed hat descends from traditional women's hats on the Welsh/Cornish Celtic fringe, and that's probably as good a point of origin as any. Presumably, this cultural outlier was perceived as being more magical than others, and so the old women - the keepers of the old ways - with their traditional garb, would have become the source of the image of a witch. But a lot of that is speculation.
It is worthwhile to add to this that the far west of Britain (i.e. Wales and Cornwall) were often regarded as places where the supernatural and magic were extravagantly represented. Local healers and cunning folk were ubiquitous elsewhere, but it was easy for people to imagine that the ones with the most potency lived in the west. There and because of this, a traditional hat was easily associated with witchcraft in English culture.
Rosemary Ellen Guiley, The Encyclopedia of Witches and Witchcraft (1999), suggests that "there are different hypotheses as to why brooms are associated with witches. One is that brooms are a symbol of female domesticity, a tool of every woman, and most witches were women." This is a fairly weak link, but lacking a stronger one, it may be all we have.
This approach to hats was not specific to Wales and Cornwall. Puritans famously wore black conical hats (with flat tops), and although some of the Puritans drew from the south west of Britain (they left from Plymouth!), this fashion for hat was widespread, but it was particularly common in Wales and Cornwall, places looked to by the English for their magic and supernatural connections.
So, to be clear, is it a fact that Welsh/Cornish women’s hats were pointed, and the speculation is that this led to the stereotypical witch’s hat? If so, during what period was this the Welsh/Cornish fashion?
Broad-brimmed, black, conical (with flat top or pointed) hats were traditional for women in some parts of Wales and Cornwall during the pre-modern period. They probably settled into a tradition during the medieval period (likely later than earlier) and they were merely one of the regional options, since hats for women tended to be parish/district specific as a means of self-identification.