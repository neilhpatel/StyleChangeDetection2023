Criminal attorney for the assault allegations and a family attorney for handling custody. Until there is a custody agreement in place, he does not have to let you see or take the children, even if the restraining order ends up getting dropped (most likely it will be). This is because until a formal custody agreement is made, each parent basically has 100% custody, so neither of you can be forced to give the other parent the child until a court order for custody has been made. If you had the kids, you wouldn't have to let him see them or give them to him either.
The most important thing you can do is take care of yourself. You sound like you have much more together than most people in your situation. So, most of the game planning for the case can wait until Monday, but you're dealing with a ton of emotional trauma. Deal with as much of it as you can now so that it can't be used against you later.
Try to get a firm that does both, when it comes to these messy situations having lawyers who communicate with one another can help.
Your lawyer will have a much more complete understanding of the situation and will give you much better advice than internet strangers can, so it's better to wait for the good advice than self-sabotage by doing things that ultimately undermine your lawyer's strategy. Maintain the notes and timelines, though.
California is very heavily a 50/50 state. Those notes about how he's treated you and letters likely will not affect custody at all, what will affect is if either of you have been arrested for harming the kids or if he's been in jail for his substance abuse issues. If none of those things happened, both of you will likely be considered fit parents and will share custody.
Do you have a safe place to stay? Even if yes, contact a domestic violence shelter. They have resources and experience to help you. You may need to get yourself and your children away from him in the future.
We donâ€™t have your exact location in California, so please call the National Domestic Abuse Hotline at 1-800-799-7233. What you have described fits the patterns of abuse that these folks are experts at dealing with. They will connect you with local resources, who will be able to help you navigate the legal, social, financial, and emotional issues you and your children face as you free yourselves from your abuser. Best of luck to you.