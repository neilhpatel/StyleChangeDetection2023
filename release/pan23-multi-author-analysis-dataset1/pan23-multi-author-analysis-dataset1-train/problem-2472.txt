This might only answer one slice of time and place to your question, but one of the bars the Mafia protected was the Stonewall Inn, which would become the epicenter of the Stonewall Riots. /u/sunagainstgold wrote up an awesome piece about the relationship between Mafia protection of gay bars in 1960s NYC.
Excellent question. Gambetta points out that, in Sicily, this is one of the pressures on prices: the mafia have to price their protection services to be significantly lower than taxes such that it is worth the slight extra risk (for goods with a legitimate market—when there’s not a legitimate market, they can charge a significantly higher premium).
While he doesn’t go into the American mafia, so I will have to leave that to others, Gambetta emphasizes that the main thing that Sicilian mafia deal in is not violence, but trust, information, and above all protection. They function as a quasi-, entrepreneurial state in areas where the state is weak, dysfunctional, or non-existent, he argues.