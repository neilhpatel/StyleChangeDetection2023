Hey OP sorry I'm a little late on this. I work in animal care so I thought I'd chime in on the microchip part. Depending on which company the microchip is through you have to have permission from the previous owner to change information if it is already registered to her. Maybe talk to your vet about removing it and getting your own put in? A lot of vets will not do this as it is seen as a little fishy and an unnecessary surgery but maybe in your case it would be considered. Good luck!
In regards to the restraining order, considering she's already sent AC (And this is gonna be the main problem), definitely file it but I'd expect to bring documentation showing she surrendered the dog to you (Especially considering the microchip).
NAL. This comes up now and then. As others have mentioned microchip/change the registration if possible. The other is get a copy of all vet visits and costs, an estimate of food costs, cost of spay/neuter, and boarding for 2 years (call a few local places to get an estimate on daily rates). Then, offer the dog back for a reimbursement of your losses. If they are claiming you were temporarily caring for the dog, provide a bill for your services.