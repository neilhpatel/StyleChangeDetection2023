China supports NK because it's a buffer state. China sees SK as an American jumping off point and absolutely has a problem with anything that threatens their border. American troops in NK is the only thing required for China to intervene. I don't know know if there is too much historical ignorance or too many armchair quarterbacks in here but China would absolutely declare war on anybody threatening NK. Not only have they done it before but have made it quite clear that they'll do it again.
I love international politics. North Korea rattles the sabre and launches rocket after rocket Japan's way. Japan decides they need more security against their neighbor who keeps lobbing rockets their way, "How dare you be so aggressive!".
Authoritarian governments MUST have enemies. This is just the most extreme example. They know they cannot win a land war with anyone, they would be starving a month in.
Honestly... I don't understand why NK is allowed to "bully" those around them. If it comes down to "it", realistically NK would get mopped. Just saying.