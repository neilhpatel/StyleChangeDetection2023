Here's something for you to consider: If they were ineffective, why would militaries continue using them? Wouldn't ineffective measures be taken advantage of by their opponents? What you're missing here is largely the pragmatics of musket use, which inform a significant portion of the tactics at play. I commend to your attention the ; you want everything under a heading that says 'linear tactics'. Beyond that, some further threads for your perusal:
Also interesting to note is how many of the light infantry manuals from the 19th century continue to emphasize for skirmishers to work in pairs of at least two, the second man not firing until the first has finished loading his weapon and so on so that there is always at least one man who can be ready to fire between them. (Whether or not many skirmishers actually continued to observe this rule once the fighting really began is a whole other matter, but it's interesting.).
As such, I'm skeptical of explanations prioritizing technology; the Napoleonic Wars were won and lost with practically the same technology of the Seven Years War, but the actual fighting methods were radically different in almost every way.
So, why line infantry? One key thing to realize is that they were not working with nice modern guns, and so they tried to get more oomph out of their slow loading guns through volley fire. Having all of your men in one line fire at once while the other ranks reload means you're sending a lot of bullets at the enemy at once, the slow reload speed of the musket is made up for, and the poor accuracy of smoothbore muskets is countered by sheer volume of shot. Sending out loose skirmishing forces just would not be able to send the same amount of fire back at volley firing line infantry.