Simply put, the South could not last in a long contest. Its economy would collapse eventually, its food supply as well. And Lee could not replace the men he lost. That complicated the situation, for the South was aiming to win by not losing. If they managed to retain their independence and fend off the Northern invasions, they would win. The North would have to defeat them militarily and occupy the Confederacy to win. If they inflicted enough losses, and made the war too painful, the North's will could be broken, and Southern independence would be secured.
So, to recap, in a war for independence the rebel nation can win by not losing. This means, resisting until their enemy's will is destroyed. There are two ways: either by attrition, rendering the war too costly to continue; or by a decisive victory. But the South could not win a war for attrition due to the North's overwhelming resource advantage. Lee believed that he could win the war by destroying the Army of the Potomac, before the South's resources were depleted. That's why he was so aggresive.
Even though McLellan knew the exact movements of Lee's army by the discovery of his orders, the mountains that Lee manoeuvred behind gave the Confederates excellent defensive positions and he was able to delay McLellan's attacks while concentrating his army at Sharpsburg. McLellan allowed Lee to choose the time and place of the engagement and to fight a defensive battle on defensive terrain. McLellan was thoroughly defeated militarily in this campaign, but because Lee withdrew from the field Lincoln was able to claim victory.